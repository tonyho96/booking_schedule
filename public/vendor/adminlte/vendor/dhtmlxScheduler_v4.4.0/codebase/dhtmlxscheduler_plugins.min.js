/*!
 dhtmlxScheduler v.4.2.0 Professional
 This software is covered by DHTMLX Enterprise License. Usage without proper license is prohibited.
 (c) Dinamenta, UAB.

 ------------- Active Links Plugin ------------
 */
;Scheduler.plugin(function(a){a.config.active_link_view="day",a._active_link_click=function(c){var b=c.target||event.srcElement,d=b.getAttribute("jump_to"),e=a.date.str_to_date(a.config.api_date);return d?(a.setCurrentView(e(d),a.config.active_link_view),c&&c.preventDefault&&c.preventDefault(),!1):void 0},a.attachEvent("onTemplatesReady",function(){var c=function(e,d){d=d||e+"_scale_date",a.templates["_active_links_old_"+d]||(a.templates["_active_links_old_"+d]=a.templates[d]);var f=a.templates["_active_links_old_"+d],g=a.date.date_to_str(a.config.api_date);a.templates[d]=function(h){return"<a jump_to='"+g(h)+"' href='#'>"+f(h)+"</a>"}};if(c("week"),c("","month_day"),this.matrix){for(var b in this.matrix){c(b)}}this._detachDomEvent(this._obj,"click",a._active_link_click),dhtmlxEvent(this._obj,"click",a._active_link_click)})});
/*!
 ------------- Cookie Plugin ------------
 */
;Scheduler.plugin(function(a){(function(){function c(g,f,h){var i=g+"="+h+(f?("; "+f):"");document.cookie=i}function b(g){var h=g+"=";if(document.cookie.length>0){var i=document.cookie.indexOf(h);if(i!=-1){i+=h.length;var f=document.cookie.indexOf(";",i);if(f==-1){f=document.cookie.length}return document.cookie.substring(i,f)}}return""}var e=true;a.attachEvent("onBeforeViewChange",function(n,f,j,l){if(e&&a._get_url_nav){var h=a._get_url_nav();if(h.date||h.mode||h.event){e=false}}var g=(a._obj.id||"scheduler")+"_settings";if(e){e=false;var k=b(g);if(k){if(!a._min_date){a._min_date=l}k=unescape(k).split("@");k[0]=this.templates.xml_date(k[0]);var o=this.isViewExists(k[1])?k[1]:j,i=!isNaN(+k[0])?k[0]:l;window.setTimeout(function(){a.setCurrentView(i,o)},1);return false}}var p=escape(this.templates.xml_format(l||f)+"@"+(j||n));c(g,"expires=Sun, 31 Jan 9999 22:00:00 GMT; path=/",p);return true});var d=a._load;a._load=function(){var f=arguments;if(!a._date&&a._load_mode){var g=this;window.setTimeout(function(){d.apply(g,f)},1)}else{d.apply(this,f)}}})()});
/*!
 ------------- Grid View Plugin ------------
 */
(function(){scheduler._grid={sort_rules:{"int":function(d,c,e){return e(d)*1<e(c)*1?1:-1},str:function(d,c,e){return e(d)<e(c)?1:-1},date:function(d,c,e){return new Date(e(d))<new Date(e(c))?1:-1}},_getObjName:function(a){return"grid_"+a},_getViewName:function(a){return a.replace(/^grid_/,"")}}})();scheduler.createGridView=function(f){var a=f.name||"grid";var c=scheduler._grid._getObjName(a);scheduler.config[a+"_start"]=f.from||(new Date(0));scheduler.config[a+"_end"]=f.to||(new Date(9999,1,1));scheduler[c]=f;scheduler[c].defPadding=8;scheduler[c].columns=scheduler[c].fields;scheduler[c].unit=f.unit||"month";scheduler[c].step=f.step||1;delete scheduler[c].fields;function e(g){return !(g!==undefined&&(g*1!=g||g<0))}var d=scheduler[c].columns;for(var b=0;b<d.length;b++){if(e(d[b].width)){d[b].initialWidth=d[b].width}if(!e(d[b].paddingLeft)){delete d[b].paddingLeft}if(!e(d[b].paddingRight)){delete d[b].paddingRight}}scheduler[c].select=f.select===undefined?true:f.select;if(scheduler.locale.labels[a+"_tab"]===undefined){scheduler.locale.labels[a+"_tab"]=scheduler[c].label||scheduler.locale.labels.grid_tab}scheduler[c]._selected_divs=[];scheduler.date[a+"_start"]=function(g){if(scheduler.date[f.unit+"_start"]){return scheduler.date[f.unit+"_start"](g)}else{return(g)}};scheduler.date["add_"+a]=function(g,h){return scheduler.date.add(g,h*scheduler[c].step,scheduler[c].unit)};scheduler.templates[a+"_date"]=function(h,g){return scheduler.templates.day_date(h)+" - "+scheduler.templates.day_date(g)};scheduler.templates[a+"_full_date"]=function(i,g,h){if(scheduler.isOneDayEvent(h)){return this[a+"_single_date"](i)}else{return scheduler.templates.day_date(i)+" &ndash; "+scheduler.templates.day_date(g)}};scheduler.templates[a+"_single_date"]=function(g){return scheduler.templates.day_date(g)+" "+this.event_date(g)};scheduler.templates[a+"_field"]=function(h,g){return g[h]};scheduler.attachEvent("onTemplatesReady",function(){scheduler.attachEvent("onDblClick",function(j,i){if(this._mode==a){scheduler._click.buttons.details(j);return false}return true});scheduler.attachEvent("onClick",function(j,i){if(this._mode==a&&scheduler[c].select){scheduler._grid.unselectEvent("",a);scheduler._grid.selectEvent(j,a,i);return false}return true});var h=scheduler.render_data;scheduler.render_data=function(i){if(this._mode==a){scheduler._grid._fill_grid_tab(c)}else{return h.apply(this,arguments)}};var g=scheduler.render_view_data;scheduler.render_view_data=function(){var i=scheduler._els.dhx_cal_data[0].lastChild;if(this._mode==a&&i){scheduler._grid._gridScrollTop=i.scrollTop}return g.apply(this,arguments)}});scheduler[a+"_view"]=function(j){scheduler._grid._sort_marker=null;delete scheduler._gridView;scheduler._grid._gridScrollTop=0;scheduler._rendered=[];scheduler[c]._selected_divs=[];if(j){var i=null,g=null;var h=scheduler[c];if(h.paging){i=scheduler.date[a+"_start"](new Date(scheduler._date));g=scheduler.date["add_"+a](i,1)}else{i=scheduler.config[a+"_start"];g=scheduler.config[a+"_end"]}scheduler._min_date=i;scheduler._max_date=g;scheduler._grid.set_full_view(c);var k="";if(+i>+new Date(0)&&+g<+(new Date(9999,1,1))){k=scheduler.templates[a+"_date"](i,g)}scheduler._els.dhx_cal_date[0].innerHTML=k;scheduler._gridView=c}else{}}};scheduler.dblclick_dhx_grid_area=function(){if(!this.config.readonly&&this.config.dblclick_create){this.addEventNow()}};if(scheduler._click.dhx_cal_header){scheduler._old_header_click=scheduler._click.dhx_cal_header}scheduler._click.dhx_cal_header=function(b){if(scheduler._gridView){var a=b||window.event;var c=scheduler._grid.get_sort_params(a,scheduler._gridView);scheduler._grid.draw_sort_marker(a.originalTarget||a.srcElement,c.dir);scheduler.clear_view();scheduler._grid._fill_grid_tab(scheduler._gridView,c)}else{if(scheduler._old_header_click){return scheduler._old_header_click.apply(this,arguments)}}};scheduler._grid.selectEvent=function(d,b,a){if(scheduler.callEvent("onBeforeRowSelect",[d,a])){var c=scheduler._grid._getObjName(b);scheduler.for_rendered(d,function(e){e.className+=" dhx_grid_event_selected";scheduler[c]._selected_divs.push(e)});scheduler._select_id=d}};scheduler._grid._unselectDiv=function(a){a.className=a.className.replace(/ dhx_grid_event_selected/,"")};scheduler._grid.unselectEvent=function(d,b){var c=scheduler._grid._getObjName(b);if(!c||!scheduler[c]._selected_divs){return}if(!d){for(var a=0;a<scheduler[c]._selected_divs.length;a++){scheduler._grid._unselectDiv(scheduler[c]._selected_divs[a])}scheduler[c]._selected_divs=[]}else{for(var a=0;a<scheduler[c]._selected_divs.length;a++){if(scheduler[c]._selected_divs[a].getAttribute("event_id")==d){scheduler._grid._unselectDiv(scheduler[c]._selected_divs[a]);scheduler[c]._selected_divs.slice(a,1);break}}}};scheduler._grid.get_sort_params=function(a,c){var e=a.originalTarget||a.srcElement;var h="desc";if(e.className=="dhx_grid_view_sort"){e=e.parentNode}if(!e.className||e.className.indexOf("dhx_grid_sort_asc")==-1){h="asc"}var d=0;for(var b=0;b<e.parentNode.childNodes.length;b++){if(e.parentNode.childNodes[b]==e){d=b;break}}var j=null;if(scheduler[c].columns[d].template){var k=scheduler[c].columns[d].template;j=function(i){return k(i.start_date,i.end_date,i)}}else{var g=scheduler[c].columns[d].id;if(g=="date"){g="start_date"}j=function(i){return i[g]}}var f=scheduler[c].columns[d].sort;if(typeof f!="function"){f=scheduler._grid.sort_rules[f]||scheduler._grid.sort_rules.str}return{dir:h,value:j,rule:f}};scheduler._grid.draw_sort_marker=function(b,c){if(b.className=="dhx_grid_view_sort"){b=b.parentNode}if(scheduler._grid._sort_marker){scheduler._grid._sort_marker.className=scheduler._grid._sort_marker.className.replace(/( )?dhx_grid_sort_(asc|desc)/,"");scheduler._grid._sort_marker.removeChild(scheduler._grid._sort_marker.lastChild)}b.className+=" dhx_grid_sort_"+c;scheduler._grid._sort_marker=b;var a="<div class='dhx_grid_view_sort' style='left:"+(+b.style.width.replace("px","")-15+b.offsetLeft)+"px'>&nbsp;</div>";b.innerHTML+=a};scheduler._grid.sort_grid=function(b){var b=b||{dir:"desc",value:function(c){return c.start_date},rule:scheduler._grid.sort_rules.date};var a=scheduler.get_visible_events();if(b.dir=="desc"){a.sort(function(d,c){return b.rule(d,c,b.value)})}else{a.sort(function(d,c){return -b.rule(d,c,b.value)})}return a};scheduler._grid.set_full_view=function(c){if(c){var a=scheduler.locale.labels;var b=scheduler._grid._print_grid_header(c);scheduler._els.dhx_cal_header[0].innerHTML=b;scheduler._table_view=true;scheduler.set_sizes()}};scheduler._grid._calcPadding=function(b,a){var c=(b.paddingLeft!==undefined?1*b.paddingLeft:scheduler[a].defPadding)+(b.paddingRight!==undefined?1*b.paddingRight:scheduler[a].defPadding);return c};scheduler._grid._getStyles=function(e,b){var a=[],d="";for(var c=0;b[c];c++){d=b[c]+":";switch(b[c]){case"text-align":if(e.align){a.push(d+e.align)}break;case"vertical-align":if(e.valign){a.push(d+e.valign)}break;case"padding-left":if(e.paddingLeft!==undefined){a.push(d+(e.paddingLeft||"0")+"px")}break;case"padding-right":if(e.paddingRight!==undefined){a.push(d+(e.paddingRight||"0")+"px")}break}}return a};scheduler._grid._fill_grid_tab=function(g,d){var b=scheduler._date;var k=scheduler._grid.sort_grid(d);var c=scheduler[g].columns;var f="<div>";var a=-2;for(var e=0;e<c.length;e++){var h=scheduler._grid._calcPadding(c[e],g);a+=c[e].width+h;if(e<c.length-1){f+="<div class='dhx_grid_v_border' style='left:"+(a)+"px'></div>"}}f+="</div>";f+="<div class='dhx_grid_area'><table>";for(var e=0;e<k.length;e++){f+=scheduler._grid._print_event_row(k[e],g)}f+="</table></div>";scheduler._els.dhx_cal_data[0].innerHTML=f;scheduler._els.dhx_cal_data[0].lastChild.scrollTop=scheduler._grid._gridScrollTop||0;var j=scheduler._els.dhx_cal_data[0].getElementsByTagName("tr");scheduler._rendered=[];for(var e=0;e<j.length;e++){scheduler._rendered[e]=j[e]}};scheduler._grid._print_event_row=function(j,g){var n=[];if(j.color){n.push("background:"+j.color)}if(j.textColor){n.push("color:"+j.textColor)}if(j._text_style){n.push(j._text_style)}if(scheduler[g]["rowHeight"]){n.push("height:"+scheduler[g]["rowHeight"]+"px")}var a="";if(n.length){a="style='"+n.join(";")+"'"}var c=scheduler[g].columns;var e=scheduler.templates.event_class(j.start_date,j.end_date,j);var f="<tr class='dhx_grid_event"+(e?" "+e:"")+"' event_id='"+j.id+"' "+a+">";var b=scheduler._grid._getViewName(g);var m=["text-align","vertical-align","padding-left","padding-right"];for(var d=0;d<c.length;d++){var l;if(c[d].template){l=c[d].template(j.start_date,j.end_date,j)}else{if(c[d].id=="date"){l=scheduler.templates[b+"_full_date"](j.start_date,j.end_date,j)}else{if(c[d].id=="start_date"||c[d].id=="end_date"){l=scheduler.templates[b+"_single_date"](j[c[d].id])}else{l=scheduler.templates[b+"_field"](c[d].id,j)}}}var k=scheduler._grid._getStyles(c[d],m);var h=c[d].css?(' class="'+c[d].css+'"'):"";f+="<td style='width:"+(c[d].width)+"px;"+k.join(";")+"' "+h+">"+l+"</td>"}f+="<td class='dhx_grid_dummy'></td></tr>";return f};scheduler._grid._print_grid_header=function(h){var j="<div class='dhx_grid_line'>";var f=scheduler[h].columns;var e=[];var m=f.length;var a=scheduler._obj.clientWidth-2*f.length-20;for(var c=0;c<f.length;c++){var b=f[c].initialWidth*1;if(!isNaN(b)&&f[c].initialWidth!==""&&f[c].initialWidth!==null&&typeof f[c].initialWidth!="boolean"){m--;a-=b;e[c]=b}else{e[c]=null}}var d=Math.floor(a/m);var n=["text-align","padding-left","padding-right"];for(var g=0;g<f.length;g++){var l=!e[g]?d:e[g];f[g].width=l-scheduler._grid._calcPadding(f[g],h);var k=scheduler._grid._getStyles(f[g],n);j+="<div style='width:"+(f[g].width-1)+"px;"+k.join(";")+"'>"+(f[g].label===undefined?f[g].id:f[g].label)+"</div>"}j+="</div>";return j};
/*!
 ------------- Multisection Plugin ------------
 */
;scheduler.config.multisection=!0,scheduler.config.multisection_shift_all=!0,scheduler.config.section_delemiter=",",scheduler.attachEvent("onSchedulerReady",function(){var g=scheduler._update_unit_section;scheduler._update_unit_section=function(a){return scheduler._update_sections(a,g)};var d=scheduler._update_timeline_section;scheduler._update_timeline_section=function(a){return scheduler._update_sections(a,d)},scheduler.isMultisectionEvent=function(i){if(i&&this._get_multisection_view()){var a=this._get_event_sections(i);return a.length>1}return !1},scheduler._get_event_sections=function(k){var j=this._get_section_property(),i=k[j]||"";return this._parse_event_sections(i)},scheduler._parse_event_sections=function(a){return a instanceof Array?a:a.toString().split(scheduler.config.section_delemiter)},scheduler._register_copies_array=function(i){for(var a=0;a<i.length;a++){this._register_copy(i[a])}},scheduler._register_copy=function(k){this._multisection_copies[k.id]||(this._multisection_copies[k.id]={});var j=k[this._get_section_property()],i=this._multisection_copies[k.id];i[j]||(i[j]=k)},scheduler._get_copied_event=function(o,l){if(!this._multisection_copies[o]){return null}if(this._multisection_copies[o][l]){return this._multisection_copies[o][l]}var j=this._multisection_copies[o];if(scheduler._drag_event&&scheduler._drag_event._orig_section&&j[scheduler._drag_event._orig_section]){return j[scheduler._drag_event._orig_section]}var k=1/0,p=null;for(var m in j){j[m]._sorder<k&&(p=j[m],k=j[m]._sorder)}return p},scheduler._clear_copied_events=function(){this._multisection_copies={}},scheduler._clear_copied_events(),scheduler._split_events=function(p){var l=[],j=this._get_multisection_view(),k=this._get_section_property();if(j){for(var u=0;u<p.length;u++){var m=this._get_event_sections(p[u]);if(m.length>1){for(var o=0;o<m.length;o++){if("undefined"!=typeof j.order[m[o]]){var q=this._lame_copy({},p[u]);q[k]=m[o],l.push(q)}}}else{l.push(p[u])}}}else{l=p}return l},scheduler._get_multisection_view=function(){return this.config.multisection?scheduler._get_section_view():!1};var b=scheduler.get_visible_events;scheduler.get_visible_events=function(){this._clear_copied_events();var i=b.apply(this,arguments);if(this._get_multisection_view()){i=this._split_events(i);for(var a=0;a<i.length;a++){this.is_visible_events(i[a])||(i.splice(a,1),a--)}this._register_copies_array(i)}return i},scheduler._rendered_events={};var c=scheduler.render_view_data;scheduler.render_view_data=function(i,a){return this._get_multisection_view()&&i&&(i=this._split_events(i),this._restore_render_flags(i)),c.apply(this,[i,a])},scheduler._restore_render_flags=function(o){for(var l=this._get_section_property(),j=0;j<o.length;j++){var k=o[j],p=scheduler._get_copied_event(k.id,k[l]);if(p){for(var m in p){0===m.indexOf("_")&&(k[m]=p[m])}}}},scheduler._update_sections=function(u,y){var w=u.view,q=u.event,m=u.pos;if(scheduler.isMultisectionEvent(q)){if(scheduler._drag_event._orig_section||(scheduler._drag_event._orig_section=m.section),scheduler._drag_event._orig_section!=m.section){var z=w.order[m.section]-w.order[scheduler._drag_event._orig_section];if(z){var j=this._get_event_sections(q),v=[],k=!0;if(scheduler.config.multisection_shift_all){for(var x=0;x<j.length;x++){var p=scheduler._shift_sections(w,j[x],z);if(null===p){v=j,k=!1;break}v[x]=p}}else{for(var x=0;x<j.length;x++){if(j[x]==m.section){v=j,k=!1;break}if(j[x]==scheduler._drag_event._orig_section){var p=scheduler._shift_sections(w,j[x],z);if(null===p){v=j,k=!1;break}v[x]=p}else{v[x]=j[x]}}}k&&(scheduler._drag_event._orig_section=m.section),q[scheduler._get_section_property()]=v.join(",")}}}else{y.apply(scheduler,[u])}},scheduler._shift_sections=function(m,l,j){for(var k in m.order){if(m.order[k]-m.order[l]==j){return k}}return null};var h=scheduler._get_blocked_zones;scheduler._get_blocked_zones=function(o,l,j,k,m){if(l&&this.config.multisection){l=this._parse_event_sections(l);for(var n=[],p=0;p<l.length;p++){n=n.concat(h.apply(this,[o,l[p],j,k,m]))}return n}return h.apply(this,arguments)};var f=scheduler._check_sections_collision;scheduler._check_sections_collision=function(o,l){if(this.config.multisection&&this._get_section_view()){o=this._split_events([o]),l=this._split_events([l]);for(var j=!1,k=0,q=o.length;q>k&&!j;k++){for(var m=0,p=l.length;p>m;m++){if(f.apply(this,[o[k],l[m]])){j=!0;break}}}return j}return f.apply(this,arguments)}});
/*!
 ------------- Quick Info Plugin ------------
 */
;Scheduler.plugin(function(a){a.config.icons_select=["icon_details","icon_delete"],a.config.details_on_create=!0,a.config.show_quick_info=!0,a.xy.menu_width=0,a.attachEvent("onClick",function(b){return a.showQuickInfo(b),!0}),function(){for(var c=["onEmptyClick","onViewChange","onLightbox","onBeforeEventDelete","onBeforeDrag"],b=function(){return a._hideQuickInfo(),!0},d=0;d<c.length;d++){a.attachEvent(c[d],b)}}(),a.templates.quick_info_title=function(d,c,b){return b.text.substr(0,50)},a.templates.quick_info_content=function(d,c,b){return b.details||b.text},a.templates.quick_info_date=function(c,b,d){return a.isOneDayEvent(d)?a.templates.day_date(c,b,d)+" "+a.templates.event_header(c,b,d):a.templates.week_date(c,b,d)},a.showQuickInfo=function(c){if(c!=this._quick_info_box_id&&this.config.show_quick_info){this.hideQuickInfo(!0);var b=this._get_event_counter_part(c);b&&(this._quick_info_box=this._init_quick_info(b),this._fill_quick_data(c),this._show_quick_info(b))}},a._hideQuickInfo=function(){a.hideQuickInfo()},a.hideQuickInfo=function(c){var b=this._quick_info_box;if(this._quick_info_box_id=0,b&&b.parentNode){var d=b._offsetWidth;if(a.config.quick_info_detached){return b.parentNode.removeChild(b)}"auto"==b.style.right?b.style.left=-d+"px":b.style.right=-d+"px",c&&b.parentNode.removeChild(b)}},dhtmlxEvent(window,"keydown",function(b){27==b.keyCode&&a.hideQuickInfo()}),a._show_quick_info=function(d){var b=a._quick_info_box;a._obj.appendChild(b);var e=b.offsetWidth,c=b.offsetHeight;a.config.quick_info_detached?(b.style.left=d.left-d.dx*(e-d.width)+"px",b.style.top=d.top-(d.dy?c:-d.height)+"px"):(b.style.top=this.xy.scale_height+this.xy.nav_height+20+"px",1==d.dx?(b.style.right="auto",b.style.left=-e+"px",setTimeout(function(){b.style.left="-10px"},1)):(b.style.left="auto",b.style.right=-e+"px",setTimeout(function(){b.style.right="-10px"},1)),b.className=b.className.replace("dhx_qi_left","").replace("dhx_qi_right","")+" dhx_qi_"+(1==d?"left":"right"))},a.attachEvent("onTemplatesReady",function(){if(a.hideQuickInfo(),this._quick_info_box){var b=this._quick_info_box;b.parentNode&&b.parentNode.removeChild(b),this._quick_info_box=null}}),a._quick_info_onscroll_handler=function(){a.hideQuickInfo()},a._init_quick_info=function(){if(!this._quick_info_box){var d=a.xy,b=this._quick_info_box=document.createElement("div");b.className="dhx_cal_quick_info",a.$testmode&&(b.className+=" dhx_no_animate");var f='<div class="dhx_cal_qi_title" style="height:'+d.quick_info_title+'px"><div class="dhx_cal_qi_tcontent"></div><div  class="dhx_cal_qi_tdate"></div></div><div class="dhx_cal_qi_content"></div>';f+='<div class="dhx_cal_qi_controls" style="height:'+d.quick_info_buttons+'px">';for(var c=a.config.icons_select,e=0;e<c.length;e++){f+='<div class="dhx_qi_big_icon '+c[e]+'" title="'+a.locale.labels[c[e]]+"\"><div class='dhx_menu_icon "+c[e]+"'></div><div>"+a.locale.labels[c[e]]+"</div></div>"}f+="</div>",b.innerHTML=f,dhtmlxEvent(b,"click",function(g){g=g||event,a._qi_button_click(g.target||g.srcElement)}),a.config.quick_info_detached&&(a._detachDomEvent(a._els.dhx_cal_data[0],"scroll",a._quick_info_onscroll_handler),dhtmlxEvent(a._els.dhx_cal_data[0],"scroll",a._quick_info_onscroll_handler))}return this._quick_info_box},a._qi_button_click=function(d){var b=a._quick_info_box;if(d&&d!=b){var e=d.className;if(-1!=e.indexOf("_icon")){var c=a._quick_info_box_id;a._click.buttons[e.split(" ")[1].replace("icon_","")](c)}else{a._qi_button_click(d.parentNode)}}},a._get_event_counter_part=function(e){for(var b=a.getRenderedEvent(e),j=0,c=0,g=b;g&&g!=a._obj;){j+=g.offsetLeft,c+=g.offsetTop-g.scrollTop,g=g.offsetParent}if(g){var f=j+b.offsetWidth/2>a._x/2?1:0,h=c+b.offsetHeight/2>a._y/2?1:0;return{left:j,top:c,dx:f,dy:h,width:b.offsetWidth,height:b.offsetHeight}}return 0},a._fill_quick_data=function(d){var b=a.getEvent(d),g=a._quick_info_box;a._quick_info_box_id=d;var c=g.firstChild.firstChild;c.innerHTML=a.templates.quick_info_title(b.start_date,b.end_date,b);var f=c.nextSibling;f.innerHTML=a.templates.quick_info_date(b.start_date,b.end_date,b);var e=g.firstChild.nextSibling;e.innerHTML=a.templates.quick_info_content(b.start_date,b.end_date,b)}});
/*!
 ------------- Read Only Plugin ------------
 */
;Scheduler.plugin(function(a){a.attachEvent("onTemplatesReady",function(){function e(q,m,l,k){for(var v=m.getElementsByTagName(q),p=l.getElementsByTagName(q),o=p.length-1;o>=0;o--){var l=p[o];if(k){var u=document.createElement("SPAN");u.className="dhx_text_disabled",u.innerHTML=k(v[o]),l.parentNode.insertBefore(u,l),l.parentNode.removeChild(l)}else{l.disabled=!0,m.checked&&(l.checked=!0)}}}var c=a.config.lightbox.sections.slice(),b=a.config.buttons_left.slice(),j=a.config.buttons_right.slice();a.attachEvent("onBeforeLightbox",function(x){if(this.config.readonly_form||this.getEvent(x).readonly){this.config.readonly_active=!0;for(var i=0;i<this.config.lightbox.sections.length;i++){this.config.lightbox.sections[i].focus=!1}}else{this.config.readonly_active=!1,a.config.lightbox.sections=c.slice(),a.config.buttons_left=b.slice(),a.config.buttons_right=j.slice()}var y=this.config.lightbox.sections;if(this.config.readonly_active){for(var i=0;i<y.length;i++){if("recurring"==y[i].type){this.config.readonly_active&&y.splice(i,1);break}}for(var p=["dhx_delete_btn","dhx_save_btn"],k=[a.config.buttons_left,a.config.buttons_right],i=0;i<p.length;i++){for(var m=p[i],v=0;v<k.length;v++){for(var n=k[v],q=-1,w=0;w<n.length;w++){if(n[w]==m){q=w;break}}-1!=q&&n.splice(q,1)}}}return this.resetLightbox(),!0});var g=a._fill_lightbox;a._fill_lightbox=function(){var l=this.getLightbox();this.config.readonly_active&&(l.style.visibility="hidden",l.style.display="block");var k=g.apply(this,arguments);if(this.config.readonly_active&&(l.style.visibility="",l.style.display="none"),this.config.readonly_active){var o=this.getLightbox(),m=this._lightbox_r=o.cloneNode(!0);m.id=a.uid(),e("textarea",o,m,function(d){return d.value}),e("input",o,m,!1),e("select",o,m,function(d){return d.options.length?d.options[Math.max(d.selectedIndex||0,0)].text:""}),o.parentNode.insertBefore(m,o),f.call(this,m),a._lightbox&&a._lightbox.parentNode.removeChild(a._lightbox),this._lightbox=m,a.config.drag_lightbox&&(m.firstChild.onmousedown=a._ready_to_dnd),this.setLightboxSize(),m.onclick=function(n){var d=n?n.target:event.srcElement;if(d.className||(d=d.previousSibling),d&&d.className){switch(d.className){case"dhx_cancel_btn":a.callEvent("onEventCancel",[a._lightbox_id]),a._edit_stop_event(a.getEvent(a._lightbox_id),!1),a.hide_lightbox()}}}}return k};var f=a.showCover;a.showCover=function(){this.config.readonly_active||f.apply(this,arguments)};var h=a.hide_lightbox;a.hide_lightbox=function(){return this._lightbox_r&&(this._lightbox_r.parentNode.removeChild(this._lightbox_r),this._lightbox_r=this._lightbox=null),h.apply(this,arguments)}})});Scheduler.plugin(function(a){a.config.limit_start=null,a.config.limit_end=null,a.config.limit_view=!1,a.config.check_limits=!0,a.config.mark_now=!0,a.config.display_marked_timespans=!0,a._temp_limit_scope=function(){function e(C,v,z,p,D){var k=a,x=[],m={_props:"map_to",matrix:"y_property"};for(var q in m){var A=m[q];if(k[q]){for(var w in k[q]){var y=k[q][w],B=y[A];C[B]&&(x=k._add_timespan_zones(x,a._get_blocked_zones(v[w],C[B],z,p,D)))}}}return x=k._add_timespan_zones(x,a._get_blocked_zones(v,"global",z,p,D))}var c=null,b="dhx_time_block",j="default",f=function(l,k,d){return k instanceof Date&&d instanceof Date?(l.start_date=k,l.end_date=d):(l.days=k,l.zones=d),l},g=function(l,k,d){var m="object"==typeof l?l:{days:l};return m.type=b,m.css="",k&&(d&&(m.sections=d),m=f(m,l,k)),m};a.blockTime=function(l,k,d){var m=g(l,k,d);return a.addMarkedTimespan(m)},a.unblockTime=function(l,k,d){k=k||"fullday";var m=g(l,k,d);return a.deleteMarkedTimespan(m)},a.attachEvent("onBeforeViewChange",function(l,k,d,o){function m(r,q){var p=a.config.limit_start,v=a.config.limit_end,u=a.date.add(r,1,q);return r.valueOf()>v.valueOf()||u<=p.valueOf()}return a.config.limit_view&&(o=o||k,d=d||l,m(o,d)&&k.valueOf()!=o.valueOf())?(setTimeout(function(){var i=m(k,d)?a.config.limit_start:k;a.setCurrentView(m(i,d)?null:i,d)},1),!1):!0}),a.checkInMarkedTimespan=function(t,B,F){B=B||j;for(var k=!0,z=new Date(t.start_date.valueOf()),n=a.date.add(z,1,"day"),q=a._marked_timespans;z<t.end_date;z=a.date.date_part(n),n=a.date.add(z,1,"day")){var D=+a.date.date_part(new Date(z)),w=z.getDay(),A=e(t,q,w,D,B);if(A){for(var E=0;E<A.length;E+=2){var C=a._get_zone_minutes(z),y=t.end_date>n||t.end_date.getDate()!=z.getDate()?1440:a._get_zone_minutes(t.end_date),x=A[E],p=A[E+1];if(y>x&&p>C&&(k="function"==typeof F?F(t,C,y,x,p):!1,!k)){break}}}}return !k};var h=a.checkLimitViolation=function(y){if(!y){return !0}if(!a.config.check_limits){return !0}var u=a,p=u.config,z=[];if(y.rec_type){for(var k=a.getRecDates(y),w=0;w<k.length;w++){var m=a._copy_event(y);a._lame_copy(m,k[w]),z.push(m)}}else{z=[y]}for(var q=!0,x=0;x<z.length;x++){var v=!0,m=z[x];m._timed=a.isOneDayEvent(m),v=p.limit_start&&p.limit_end?m.start_date.valueOf()>=p.limit_start.valueOf()&&m.end_date.valueOf()<=p.limit_end.valueOf():!0,v&&(v=!a.checkInMarkedTimespan(m,b,function(A,i,d,B,l){var o=!0;return l>=i&&i>=B&&((1440==l||l>d)&&(o=!1),A._timed&&u._drag_id&&"new-size"==u._drag_mode?(A.start_date.setHours(0),A.start_date.setMinutes(l)):o=!1),(d>=B&&l>d||B>i&&d>l)&&(A._timed&&u._drag_id&&"new-size"==u._drag_mode?(A.end_date.setHours(0),A.end_date.setMinutes(B)):o=!1),o})),v||(v=u.checkEvent("onLimitViolation")?u.callEvent("onLimitViolation",[m.id,m]):v),q=q&&v}return q||(u._drag_id=null,u._drag_mode=null),q};a._get_blocked_zones=function(q,w,p,v,m){var x=[];if(q&&q[w]){for(var k=q[w],u=this._get_relevant_blocked_zones(p,v,k,m),l=0;l<u.length;l++){x=this._add_timespan_zones(x,u[l].zones)}}return x},a._get_relevant_blocked_zones=function(m,l,k,d){var o=k[l]&&k[l][d]?k[l][d]:k[m]&&k[m][d]?k[m][d]:[];return o},a.attachEvent("onMouseDown",function(d){return !(d==b)}),a.attachEvent("onBeforeDrag",function(d){return d?h(a.getEvent(d)):!0}),a.attachEvent("onClick",function(d){return h(a.getEvent(d))}),a.attachEvent("onBeforeLightbox",function(i){var d=a.getEvent(i);return c=[d.start_date,d.end_date],h(d)}),a.attachEvent("onEventSave",function(l,k){if(!k.start_date||!k.end_date){var d=a.getEvent(l);k.start_date=new Date(d.start_date),k.end_date=new Date(d.end_date)}if(k.rec_type){var m=a._lame_clone(k);return a._roll_back_dates(m),h(m)}return h(k)}),a.attachEvent("onEventAdded",function(k){if(!k){return !0}var d=a.getEvent(k);return !h(d)&&a.config.limit_start&&a.config.limit_end&&(d.start_date<a.config.limit_start&&(d.start_date=new Date(a.config.limit_start)),d.start_date.valueOf()>=a.config.limit_end.valueOf()&&(d.start_date=this.date.add(a.config.limit_end,-1,"day")),d.end_date<a.config.limit_start&&(d.end_date=new Date(a.config.limit_start)),d.end_date.valueOf()>=a.config.limit_end.valueOf()&&(d.end_date=this.date.add(a.config.limit_end,-1,"day")),d.start_date.valueOf()>=d.end_date.valueOf()&&(d.end_date=this.date.add(d.start_date,this.config.event_duration||this.config.time_step,"minute")),d._timed=this.isOneDayEvent(d)),!0}),a.attachEvent("onEventChanged",function(i){if(!i){return !0}var d=a.getEvent(i);if(!h(d)){if(!c){return !1}d.start_date=c[0],d.end_date=c[1],d._timed=this.isOneDayEvent(d)}return !0}),a.attachEvent("onBeforeEventChanged",function(d){return h(d)}),a.attachEvent("onBeforeEventCreated",function(l){var k=a.getActionData(l).date,d={_timed:!0,start_date:k,end_date:a.date.add(k,a.config.time_step,"minute")};return h(d)}),a.attachEvent("onViewChange",function(){a._mark_now()}),a.attachEvent("onSchedulerResize",function(){return window.setTimeout(function(){a._mark_now()},1),!0}),a.attachEvent("onTemplatesReady",function(){a._mark_now_timer=window.setInterval(function(){a._is_initialized()&&a._mark_now()},60000)}),a._mark_now=function(l){var k="dhx_now_time";this._els[k]||(this._els[k]=[]);var d=a._currentDate(),o=this.config;if(a._remove_mark_now(),!l&&o.mark_now&&d<this._max_date&&d>this._min_date&&d.getHours()>=o.first_hour&&d.getHours()<o.last_hour){var m=this.locate_holder_day(d);this._els[k]=a._append_mark_now(m,d)}},a._append_mark_now=function(y,u){var w="dhx_now_time",p=a._get_zone_minutes(u),z={zones:[p,p+1],css:w,type:w};if(!this._table_view){if(this._props&&this._props[this._mode]){for(var k=this._els.dhx_cal_data[0].childNodes,v=[],m=0;m<k.length-1;m++){var q=y+m;z.days=q;var x=a._render_marked_timespan(z,null,q)[0];v.push(x)}return v}return z.days=y,a._render_marked_timespan(z,null,y)}return"month"==this._mode?(z.days=+a.date.date_part(u),a._render_marked_timespan(z,null,null)):void 0},a._remove_mark_now=function(){for(var m="dhx_now_time",l=this._els[m],k=0;k<l.length;k++){var d=l[k],o=d.parentNode;o&&o.removeChild(d)}this._els[m]=[]},a._marked_timespans={global:{}},a._get_zone_minutes=function(d){return 60*d.getHours()+d.getMinutes()},a._prepare_timespan_options=function(z){var G=[],N=[];if("fullweek"==z.days&&(z.days=[0,1,2,3,4,5,6]),z.days instanceof Array){for(var A=z.days.slice(),B=0;B<A.length;B++){var K=a._lame_clone(z);K.days=A[B],G.push.apply(G,a._prepare_timespan_options(K))}return G}if(!z||!(z.start_date&&z.end_date&&z.end_date>z.start_date||void 0!==z.days&&z.zones)){return G}var D=0,F=1440;"fullday"==z.zones&&(z.zones=[D,F]),z.zones&&z.invert_zones&&(z.zones=a.invertZones(z.zones)),z.id=a.uid(),z.css=z.css||"",z.type=z.type||j;var O=z.sections;if(O){for(var H in O){if(O.hasOwnProperty(H)){var L=O[H];L instanceof Array||(L=[L]);for(var B=0;B<L.length;B++){var w=a._lame_copy({},z);w.sections={},w.sections[H]=L[B],N.push(w)}}}}else{N.push(z)}for(var q=0;q<N.length;q++){var J=N[q],I=J.start_date,E=J.end_date;if(I&&E){for(var C=a.date.date_part(new Date(I)),n=a.date.add(C,1,"day");E>C;){var w=a._lame_copy({},J);delete w.start_date,delete w.end_date,w.days=C.valueOf();var k=I>C?a._get_zone_minutes(I):D,M=E>n||E.getDate()!=C.getDate()?F:a._get_zone_minutes(E);w.zones=[k,M],G.push(w),C=n,n=a.date.add(n,1,"day")}}else{J.days instanceof Date&&(J.days=a.date.date_part(J.days).valueOf()),J.zones=z.zones.slice(),G.push(J)}}return G},a._get_dates_by_index=function(m,l,k){var u=[];l=a.date.date_part(new Date(l||a._min_date)),k=new Date(k||a._max_date);for(var o=l.getDay(),p=m-o>=0?m-o:7-l.getDay()+m,q=a.date.add(l,p,"day");k>q;q=a.date.add(q,1,"week")){u.push(q)}return u},a._get_css_classes_by_config=function(i){var d=[];return i.type==b&&(d.push(b),i.css&&d.push(b+"_reset")),d.push("dhx_marked_timespan",i.css),d.join(" ")},a._get_block_by_config=function(i){var d=document.createElement("DIV");return i.html&&("string"==typeof i.html?d.innerHTML=i.html:d.appendChild(i.html)),d},a._render_marked_timespan=function(P,aa,ah){var W=[],R=a.config,T=this._min_date,ae=this._max_date,V=!1;if(!R.display_marked_timespans){return W}if(!ah&&0!==ah){if(P.days<7){ah=P.days}else{var Y=new Date(P.days);if(V=+Y,!(+ae>+Y&&+Y>=+T)){return W}ah=Y.getDay()}var ai=T.getDay();ai>ah?ah=7-(ai-ah):ah-=ai}var ab=P.zones,af=a._get_css_classes_by_config(P);if(a._table_view&&"month"==a._mode){var J=[],I=[];if(aa){J.push(aa),I.push(ah)}else{I=V?[V]:a._get_dates_by_index(ah);for(var ad=0;ad<I.length;ad++){J.push(this._scales[I[ad]])}}for(var ad=0;ad<J.length;ad++){aa=J[ad],ah=I[ad];var ac=Math.floor((this._correct_shift(ah,1)-T.valueOf())/(86400000*this._cols.length)),X=this.locate_holder_day(ah,!1)%this._cols.length;if(!this._ignores[X]){var U=a._get_block_by_config(P),G=Math.max(aa.offsetHeight-1,0),F=Math.max(aa.offsetWidth-1,0),ag=this._colsS[X],H=this._colsS.heights[ac]+(this._colsS.height?this.xy.month_scale_height+2:2)-1;U.className=af,U.style.top=H+"px",U.style.lineHeight=U.style.height=G+"px";for(var K=0;K<ab.length;K+=2){var Q=ab[ad],Z=ab[ad+1];if(Q>=Z){return[]}var B=U.cloneNode(!0);B.style.left=ag+Math.round(Q/1440*F)+"px",B.style.width=Math.round((Z-Q)/1440*F)+"px",aa.appendChild(B),W.push(B)}}}}else{var A=ah;if(this._ignores[this.locate_holder_day(ah,!1)]){return W}if(this._props&&this._props[this._mode]&&P.sections&&P.sections[this._mode]){var C=this._props[this._mode];A=this._get_section_sday(P.sections[this._mode]),C.size&&A>C.position+C.size&&(A=0)}aa=aa?aa:a.locate_holder(A);for(var ad=0;ad<ab.length;ad+=2){var Q=Math.max(ab[ad],60*R.first_hour),Z=Math.min(ab[ad+1],60*R.last_hour);if(Q>=Z){if(ad+2<ab.length){continue}return[]}var B=a._get_block_by_config(P);B.className=af;var z=24*this.config.hour_size_px+1,q=3600000;B.style.top=Math.round((60*Q*1000-this.config.first_hour*q)*this.config.hour_size_px/q)%z+"px",B.style.lineHeight=B.style.height=Math.max(Math.round(60*(Z-Q)*1000*this.config.hour_size_px/q)%z,1)+"px",aa.appendChild(B),W.push(B)}}return W},a.markTimespan=function(l){var k=a._prepare_timespan_options(l);if(k.length){for(var d=[],p=0;p<k.length;p++){var m=k[p],o=a._render_marked_timespan(m,null,null);o.length&&d.push.apply(d,o)}return d}},a.unmarkTimespan=function(l){if(l){for(var k=0;k<l.length;k++){var d=l[k];d.parentNode&&d.parentNode.removeChild(d)}}},a._marked_timespans_ids={},a.addMarkedTimespan=function(F){var w=a._prepare_timespan_options(F),B="global";if(w.length){var p=w[0].id,G=a._marked_timespans,k=a._marked_timespans_ids;k[p]||(k[p]=[]);for(var z=0;z<w.length;z++){var m=w[z],q=m.days,D=(m.zones,m.css,m.sections),x=m.type;if(m.id=p,D){for(var A in D){if(D.hasOwnProperty(A)){G[A]||(G[A]={});var E=D[A],C=G[A];C[E]||(C[E]={}),C[E][q]||(C[E][q]={}),C[E][q][x]||(C[E][q][x]=[],a._marked_timespans_types||(a._marked_timespans_types={}),a._marked_timespans_types[x]||(a._marked_timespans_types[x]=!0));var y=C[E][q][x];m._array=y,y.push(m),k[p].push(m)}}}else{G[B][q]||(G[B][q]={}),G[B][q][x]||(G[B][q][x]=[]),a._marked_timespans_types||(a._marked_timespans_types={}),a._marked_timespans_types[x]||(a._marked_timespans_types[x]=!0);var y=G[B][q][x];m._array=y,y.push(m),k[p].push(m)}}return p}},a._add_timespan_zones=function(v,z){var u=v.slice();if(z=z.slice(),!u.length){return z}for(var x=0;x<u.length;x+=2){for(var p=u[x],A=u[x+1],k=x+2==u.length,w=0;w<z.length;w+=2){var m=z[w],q=z[w+1];if(q>A&&A>=m||p>m&&q>=p){u[x]=Math.min(p,m),u[x+1]=Math.max(A,q),x-=2}else{if(!k){continue}var y=p>m?0:2;u.splice(x+y,0,m,q)}z.splice(w--,2);break}}return u},a._subtract_timespan_zones=function(v,y){for(var u=v.slice(),x=0;x<u.length;x+=2){for(var p=u[x],z=u[x+1],k=0;k<y.length;k+=2){var w=y[k],m=y[k+1];if(m>p&&z>w){var q=!1;p>=w&&m>=z&&u.splice(x,2),w>p&&(u.splice(x,2,p,w),q=!0),z>m&&u.splice(q?x+2:x,q?0:2,m,z),x-=2;break}}}return u},a.invertZones=function(d){return a._subtract_timespan_zones([0,1440],d.slice())},a._delete_marked_timespan_by_id=function(l){var k=a._marked_timespans_ids[l];if(k){for(var d=0;d<k.length;d++){for(var p=k[d],m=p._array,o=0;o<m.length;o++){if(m[o]==p){m.splice(o,1);break}}}}},a._delete_marked_timespan_by_config=function(C){var p=a._marked_timespans,y=C.sections,D=C.days,k=C.type||j,w=[];if(y){for(var m in y){if(y.hasOwnProperty(m)&&p[m]){var n=y[m];p[m][n]&&p[m][n][D]&&p[m][n][D][k]&&(w=p[m][n][D][k])}}}else{p.global[D]&&p.global[D][k]&&(w=p.global[D][k])}for(var A=0;A<w.length;A++){var q=w[A],x=a._subtract_timespan_zones(q.zones,C.zones);if(x.length){q.zones=x}else{w.splice(A,1),A--;for(var B=a._marked_timespans_ids[q.id],z=0;z<B.length;z++){if(B[z]==q){B.splice(z,1);break}}}}},a.deleteMarkedTimespan=function(m){if(arguments.length||(a._marked_timespans={global:{}},a._marked_timespans_ids={},a._marked_timespans_types={}),"object"!=typeof m){a._delete_marked_timespan_by_id(m)}else{m.start_date&&m.end_date||(m.days||(m.days="fullweek"),m.zones||(m.zones="fullday"));var l=[];if(m.type){l.push(m.type)}else{for(var k in a._marked_timespans_types){l.push(k)}}for(var w=a._prepare_timespan_options(m),p=0;p<w.length;p++){for(var q=w[p],v=0;v<l.length;v++){var u=a._lame_clone(q);u.type=l[v],a._delete_marked_timespan_by_config(u)}}}},a._get_types_to_render=function(l,k){var d=l?a._lame_copy({},l):{};for(var m in k||{}){k.hasOwnProperty(m)&&(d[m]=k[m])}return d},a._get_configs_to_render=function(l){var k=[];for(var d in l){l.hasOwnProperty(d)&&k.push.apply(k,l[d])}return k},a.attachEvent("onScaleAdd",function(G,w){if(!a._table_view||"month"==a._mode){var C=w.getDay(),p=w.valueOf(),H=this._mode,k=a._marked_timespans,A=[];if(this._props&&this._props[H]){var m=this._props[H],q=m.options,E=a._get_unit_index(m,w),x=q[E];if(w=a.date.date_part(new Date(this._date)),C=w.getDay(),p=w.valueOf(),k[H]&&k[H][x.key]){var B=k[H][x.key],F=a._get_types_to_render(B[C],B[p]);A.push.apply(A,a._get_configs_to_render(F))}}var D=k.global,z=D[p]||D[C];A.push.apply(A,a._get_configs_to_render(z));for(var y=0;y<A.length;y++){a._render_marked_timespan(A[y],G,w)}}}),a.dblclick_dhx_marked_timespan=function(k,d){a.config.dblclick_create||a.callEvent("onScaleDblClick",[a.getActionData(k).date,d,k]),a.addEventNow(a.getActionData(k).date,null,k)}},a._temp_limit_scope()});
/*!
 ------------- Timeline Plugin ------------
 */
;scheduler._temp_matrix_scope=function(){scheduler.matrix={};scheduler._merge=function(s,r){for(var t in r){if(typeof s[t]=="undefined"){s[t]=r[t]}}};scheduler.createTimelineView=function(u){scheduler._skin_init();scheduler._merge(u,{section_autoheight:true,name:"matrix",x:"time",y:"time",x_step:1,x_unit:"hour",y_unit:"day",y_step:1,x_start:0,x_size:24,y_start:0,y_size:7,render:"cell",dx:200,dy:50,event_dy:scheduler.xy.bar_height-5,event_min_dy:scheduler.xy.bar_height-5,resize_events:true,fit_events:true,show_unassigned:false,second_scale:false,round_position:false,_logic:function(y,x,w){var v={};if(scheduler.checkEvent("onBeforeSectionRender")){v=scheduler.callEvent("onBeforeSectionRender",[y,x,w])}return v}});u._original_x_start=u.x_start;if(u.x_unit!="day"){u.first_hour=u.last_hour=0}u._start_correction=u.first_hour?u.first_hour*60*60*1000:0;u._end_correction=u.last_hour?(24-u.last_hour)*60*60*1000:0;if(scheduler.checkEvent("onTimelineCreated")){scheduler.callEvent("onTimelineCreated",[u])}var r=scheduler.render_data;scheduler.render_data=function(v,x){if(this._mode==u.name){if(x&&!u.show_unassigned&&u.render!="cell"){for(var w=0;w<v.length;w++){this.clear_event(v[w]);this.render_timeline_event.call(this.matrix[this._mode],v[w],true)}}else{scheduler._renderMatrix.call(u,true,true)}}else{return r.apply(this,arguments)}};scheduler.matrix[u.name]=u;scheduler.templates[u.name+"_cell_value"]=function(v){return v?v.length:""};scheduler.templates[u.name+"_cell_class"]=function(v){return""};scheduler.templates[u.name+"_scalex_class"]=function(v){return""};scheduler.templates[u.name+"_second_scalex_class"]=function(v){return""};scheduler.templates[u.name+"_scaley_class"]=function(w,x,v){return""};scheduler.templates[u.name+"_scale_label"]=function(w,x,v){return x};scheduler.templates[u.name+"_tooltip"]=function(w,v,x){return x.text};scheduler.templates[u.name+"_date"]=function(w,v){if((w.getDay()==v.getDay()&&v-w<(24*60*60*1000))||+w==+scheduler.date.date_part(new Date(v))||(+scheduler.date.add(w,1,"day")==+v&&v.getHours()===0&&v.getMinutes()===0)){return scheduler.templates.day_date(w)}if((w.getDay()!=v.getDay()&&v-w<(24*60*60*1000))){return scheduler.templates.day_date(w)+" &ndash; "+scheduler.templates.day_date(v)}return scheduler.templates.week_date(w,v)};scheduler.templates[u.name+"_scale_date"]=scheduler.date.date_to_str(u.x_date||scheduler.config.hour_date);scheduler.templates[u.name+"_second_scale_date"]=scheduler.date.date_to_str((u.second_scale&&u.second_scale.x_date)?u.second_scale.x_date:scheduler.config.hour_date);scheduler.date["add_"+u.name+"_private"]=function(w,y){var v=y;var x=u.x_unit;if(u.x_unit=="minute"||u.x_unit=="hour"){var z=v;if(u.x_unit=="hour"){z*=60}if(!(z%(24*60))){v=z/(24*60);x="day"}}return scheduler.date.add(w,v,x)};scheduler.date["add_"+u.name]=function(x,A,C){var B=scheduler.date["add_"+u.name+"_private"](x,(u.x_length||u.x_size)*u.x_step*A);if(u.x_unit=="minute"||u.x_unit=="hour"){var z=(u.x_length||u.x_size);var y=(u.x_unit=="hour")?u.x_step*60:u.x_step;if((y*z)%(24*60)){if(+scheduler.date.date_part(new Date(x))==+scheduler.date.date_part(new Date(B))){u.x_start+=A*z}else{var w=((24*60)/(z*y))-1;var v=Math.round(w*z);if(A>0){u.x_start=u.x_start-v}else{u.x_start=v+u.x_start}}}}return B};scheduler.date[u.name+"_start"]=function(w){var x=scheduler.date[u.x_unit+"_start"]||scheduler.date.day_start;var v=x.call(scheduler.date,w);v=scheduler.date.add(v,u.x_step*u.x_start,u.x_unit);return v};scheduler.callEvent("onOptionsLoad",[u]);scheduler[u.name+"_view"]=function(v){if(v){scheduler._set_timeline_dates(u)}else{scheduler._renderMatrix.apply(u,arguments)}};var t=new Date();var s=(scheduler.date.add(t,u.x_step,u.x_unit).valueOf()-t.valueOf());scheduler["mouse_"+u.name]=function(A){var w=this._drag_event;if(this._drag_id){w=this.getEvent(this._drag_id);this._drag_event._dhx_changed=true}A.x-=u.dx;var z=scheduler._timeline_drag_date(u,A.x);A.x=0;A.force_redraw=true;A.custom=true;if(this._drag_mode=="move"&&this._drag_id&&this._drag_event){var w=this.getEvent(this._drag_id);var v=this._drag_event;A._ignores=(this._ignores_detected||u._start_correction||u._end_correction);if(v._move_delta===undefined){v._move_delta=(w.start_date-z)/60000;if(this.config.preserve_length&&A._ignores){v._move_delta=this._get_real_event_length(w.start_date,z,u);v._event_length=this._get_real_event_length(w.start_date,w.end_date,u)}}if(this.config.preserve_length&&A._ignores){var y=v._event_length;var x=this._get_fictional_event_length(z,v._move_delta,u,true);z=new Date(z-x)}else{z=scheduler.date.add(z,v._move_delta,"minute")}}if(this._drag_mode=="resize"&&w){if(this._drag_from_start&&+z>+w.end_date){this._drag_from_start=false}else{if(!this._drag_from_start&&+z<+w.start_date){this._drag_from_start=true}}A.resize_from_start=this._drag_from_start}if(u.round_position){switch(this._drag_mode){case"move":if(!this.config.preserve_length){z=p.call(u,z,false);if(u.x_unit=="day"){A.custom=false}}break;case"resize":if(this._drag_event){if(this._drag_event._resize_from_start===null||this._drag_event._resize_from_start===undefined){this._drag_event._resize_from_start=A.resize_from_start}A.resize_from_start=this._drag_event._resize_from_start;z=p.call(u,z,!this._drag_event._resize_from_start)}break}}this._resolve_timeline_section(u,A);if(A.section){this._update_timeline_section({pos:A,event:this.getEvent(this._drag_id),view:u})}A.y=Math.round((this._correct_shift(z,1)-this._min_date)/(1000*60*this.config.time_step));A.shift=this.config.time_step;return A}};scheduler._get_timeline_event_height=function(s,r){var u=s[r.y_property];var t=r.event_dy;if(r.event_dy=="full"){if(r.section_autoheight){t=r._section_height[u]-6}else{t=r.dy-3}}if(r.resize_events){t=Math.max(Math.floor(t/s._count),r.event_min_dy)}return t};scheduler._get_timeline_event_y=function(r,s){var t=r;var u=2+t*s+(t?(t*2):0);if(scheduler.config.cascade_event_display){u=2+t*scheduler.config.cascade_event_margin+(t?(t*2):0)}return u};scheduler.render_timeline_event=function(L,J){var x=L[this.y_property];if(!x){return""}var M=L._sorder;var H=i(L,false,this);var z=i(L,true,this);var F=scheduler._get_timeline_event_height(L,this);var w=F-2;if(!L._inner&&this.event_dy=="full"){w=(w+2)*(L._count-M)-2}var C=scheduler._get_timeline_event_y(L._sorder,F);var t=F+C+2;if(!this._events_height[x]||(this._events_height[x]<t)){this._events_height[x]=t}var u=scheduler.templates.event_class(L.start_date,L.end_date,L);u="dhx_cal_event_line "+(u||"");if(L._no_drag_move){u+=" no_drag_move"}var G=(L.color?("background:"+L.color+";"):"");var I=(L.textColor?("color:"+L.textColor+";"):"");var E=scheduler.templates.event_bar_text(L.start_date,L.end_date,L);var D='<div event_id="'+L.id+'" class="'+u+'" style="'+G+""+I+"position:absolute; top:"+C+"px; height: "+w+"px; left:"+H+"px; width:"+Math.max(0,z-H)+"px;"+(L._text_style||"")+'">';if(scheduler.config.drag_resize&&!scheduler.config.readonly){var s="dhx_event_resize";var v="<div class='"+s+" "+s+"_start' style='height: "+w+"px;'></div>";var r="<div class='"+s+" "+s+"_end' style='height: "+w+"px;'></div>";D+=(!L._no_resize_start?v:"")+(!L._no_resize_end?r:"")}D+=(E+"</div>");if(!J){return D}else{var K=document.createElement("DIV");K.innerHTML=D;var A=this.order[x];var B=scheduler._els.dhx_cal_data[0].firstChild.rows[A].cells[1].firstChild;scheduler._rendered.push(K.firstChild);B.appendChild(K.firstChild)}};function q(){var t=scheduler.get_visible_events();var s=[];for(var u=0;u<this.y_unit.length;u++){s[u]=[]}if(!s[v]){s[v]=[]}for(var u=0;u<t.length;u++){var v=this.order[t[u][this.y_property]];var r=0;while(this._trace_x[r+1]&&t[u].start_date>=this._trace_x[r+1]){r++}while(this._trace_x[r]&&t[u].end_date>this._trace_x[r]){if(!s[v][r]){s[v][r]=[]}s[v][r].push(t[u]);r++}}return s}function i(A,y,s){var B=0;var r=s._step;var C=s.round_position;var v=0;var u=(y)?A.end_date:A.start_date;if(u.valueOf()>scheduler._max_date.valueOf()){u=scheduler._max_date}var D=u-scheduler._min_date_timeline;if(D>0){var z=scheduler._get_date_index(s,u);if(scheduler._ignores[z]){C=true}for(var w=0;w<z;w++){B+=scheduler._cols[w]}var t=scheduler.date.add(scheduler._min_date_timeline,scheduler.matrix[scheduler._mode].x_step*z,scheduler.matrix[scheduler._mode].x_unit);if(!C){D=u-t;if(s.first_hour||s.last_hour){D=D-s._start_correction;if(D<0){D=0}v=Math.round(D/r);if(v>scheduler._cols[z]){v=scheduler._cols[z]}}else{v=Math.round(D/r)}}else{if(+u>+t&&y){v=scheduler._cols[z]}}}if(y){if(D!==0&&!C){B+=v-12}else{B+=v-14}}else{B+=v+1}return B}function p(s,u){var r=scheduler._get_date_index(this,s);var t=this._trace_x[r];if(u&&(+s!=+this._trace_x[r])){t=(this._trace_x[r+1])?this._trace_x[r+1]:scheduler.date.add(this._trace_x[r],this.x_step,this.x_unit)}return new Date(t)}function e(D){var z="";if(D&&this.render!="cell"){D.sort(this.sort||function(v,t){if(v.start_date.valueOf()==t.start_date.valueOf()){return v.id>t.id?1:-1}return v.start_date>t.start_date?1:-1});var x=[];var r=D.length;for(var J=0;J<r;J++){var L=D[J];L._inner=false;var F=(this.round_position)?p.apply(this,[L.start_date,false]):L.start_date;var M=(this.round_position)?p.apply(this,[L.end_date,true]):L.end_date;while(x.length){var s=x[x.length-1];if(s.end_date.valueOf()<=F.valueOf()){x.splice(x.length-1,1)}else{break}}var I=false;for(var E=0;E<x.length;E++){var H=x[E];if(H.end_date.valueOf()<=F.valueOf()){I=true;L._sorder=H._sorder;x.splice(E,1);L._inner=true;break}}if(x.length){x[x.length-1]._inner=true}if(!I){if(x.length){if(x.length<=x[x.length-1]._sorder){if(!x[x.length-1]._sorder){L._sorder=0}else{for(var K=0;K<x.length;K++){var B=false;for(var C=0;C<x.length;C++){if(x[C]._sorder==K){B=true;break}}if(!B){L._sorder=K;break}}}L._inner=true}else{var u=x[0]._sorder;for(var y=1;y<x.length;y++){if(x[y]._sorder>u){u=x[y]._sorder}}L._sorder=u+1;L._inner=false}}else{L._sorder=0}}x.push(L);if(x.length>(x.max_count||0)){x.max_count=x.length;L._count=x.length}else{L._count=(L._count)?L._count:1}}for(var G=0;G<D.length;G++){D[G]._count=x.max_count}for(var A=0;A<r;A++){z+=scheduler.render_timeline_event.call(this,D[A],false)}}return z}function a(N){var y="<table style='table-layout:fixed;' cellspacing='0' cellpadding='0'>";var B=[];if(scheduler._load_mode){scheduler._load()}if(this.render=="cell"){B=q.call(this)}else{var M=scheduler.get_visible_events();var H=this.order;for(var G=0;G<M.length;G++){var r=M[G];var z=r[this.y_property];var u=this.order[z];if(this.show_unassigned&&!z){for(var Q in H){if(H.hasOwnProperty(Q)){u=H[Q];if(!B[u]){B[u]=[]}var L=scheduler._lame_copy({},r);L[this.y_property]=Q;B[u].push(L)}}}else{if(!B[u]){B[u]=[]}B[u].push(r)}}}var D=0;for(var I=0;I<scheduler._cols.length;I++){D+=scheduler._cols[I]}var t=new Date();var s=scheduler._cols.length-scheduler._ignores_detected;t=((scheduler.date.add(t,this.x_step*s,this.x_unit)-t)-(this._start_correction+this._end_correction)*s)/D;this._step=t;this._summ=D;var K=scheduler._colsS.heights=[];var F=[];this._events_height={};this._section_height={};for(var I=0;I<this.y_unit.length;I++){var O=this._logic(this.render,this.y_unit[I],this);scheduler._merge(O,{height:this.dy});if(this.section_autoheight){if(this.y_unit.length*O.height<N.offsetHeight){O.height=Math.max(O.height,Math.floor((N.offsetHeight-1)/this.y_unit.length))}this._section_height[this.y_unit[I].key]=O.height}if(!O.td_className){O.td_className="dhx_matrix_scell"+((scheduler.templates[this.name+"_scaley_class"](this.y_unit[I].key,this.y_unit[I].label,this.y_unit[I]))?" "+scheduler.templates[this.name+"_scaley_class"](this.y_unit[I].key,this.y_unit[I].label,this.y_unit[I]):"")}if(!O.td_content){O.td_content=scheduler.templates[this.name+"_scale_label"](this.y_unit[I].key,this.y_unit[I].label,this.y_unit[I])}scheduler._merge(O,{tr_className:"",style_height:"height:"+O.height+"px;",style_width:"width:"+(this.dx-1)+"px;",summ_width:"width:"+D+"px;",table_className:""});var x=e.call(this,B[I]);if(this.fit_events){var C=this._events_height[this.y_unit[I].key]||0;O.height=(C>O.height)?C:O.height;O.style_height="height:"+O.height+"px;";this._section_height[this.y_unit[I].key]=O.height}y+="<tr class='"+O.tr_className+"' style='"+O.style_height+"'><td class='"+O.td_className+"' style='"+O.style_width+" height:"+(O.height-1)+"px;'>"+O.td_content+"</td>";if(this.render=="cell"){for(var G=0;G<scheduler._cols.length;G++){if(scheduler._ignores[G]){y+="<td></td>"}else{y+="<td class='dhx_matrix_cell "+scheduler.templates[this.name+"_cell_class"](B[I][G],this._trace_x[G],this.y_unit[I])+"' style='width:"+(scheduler._cols[G]-1)+"px'><div style='width:"+(scheduler._cols[G]-1)+"px'>"+scheduler.templates[this.name+"_cell_value"](B[I][G],this._trace_x[G],this.y_unit[I])+"</div></td>"}}}else{y+="<td><div style='"+O.summ_width+" "+O.style_height+" position:relative;' class='dhx_matrix_line'>";y+=x;y+="<table class='"+O.table_className+"' cellpadding='0' cellspacing='0' style='"+O.summ_width+" "+O.style_height+"' >";for(var G=0;G<scheduler._cols.length;G++){if(scheduler._ignores[G]){y+="<td></td>"}else{y+="<td class='dhx_matrix_cell "+scheduler.templates[this.name+"_cell_class"](B[I],this._trace_x[G],this.y_unit[I])+"' style='width:"+(scheduler._cols[G]-1)+"px'><div style='width:"+(scheduler._cols[G]-1)+"px'></div></td>"}}y+="</table>";y+="</div></td>"}y+="</tr>";F.push(O)}y+="</table>";this._matrix=B;N.innerHTML=y;scheduler._rendered=[];var E=scheduler._obj.getElementsByTagName("DIV");for(var I=0;I<E.length;I++){if(E[I].getAttribute("event_id")){scheduler._rendered.push(E[I])}}this._scales={};var w=N.firstChild.rows;var A=null;for(var I=0,J=F.length;I<J;I++){A=this.y_unit[I];K.push(F[I].height);var v=A.key;var P=this._scales[v]=(scheduler._isRender("cell"))?w[I]:w[I].childNodes[1].getElementsByTagName("div")[0];scheduler.callEvent("onScaleAdd",[P,v])}}function d(t){var w=scheduler._min_date;var r=scheduler._max_date;scheduler._process_ignores(w,this.x_size,this.x_unit,this.x_step,t);var s=this.x_size+(t?scheduler._ignores_detected:0);var v=0,u=0;while(+w<+r){this._trace_x[u]=new Date(w);w=scheduler.date.add(w,this.x_step,this.x_unit);if(scheduler.date[this.x_unit+"_start"]){w=scheduler.date[this.x_unit+"_start"](w)}if(!scheduler._ignores[u]){v++}u++;if(t){if(v<this.x_size&&!(+w<+r)){r=scheduler.date["add_"+this.name+"_private"](r,(this.x_length||this.x_size)*this.x_step)}else{if(v>=this.x_size){scheduler._max_date=w;break}}}}return{total:u,displayed:v}}function f(P){var R=scheduler.xy.scale_height;var r=this._header_resized||scheduler.xy.scale_height;scheduler._cols=[];scheduler._colsS={height:0};this._trace_x=[];var I=scheduler._x-this.dx-scheduler.xy.scroll_width;var u=[this.dx];var O=scheduler._els.dhx_cal_header[0];O.style.width=(u[0]+I)+"px";var v=scheduler._min_date_timeline=scheduler._min_date;var V=scheduler.config.preserve_scale_length;var y=d.call(this,V);var s=y.displayed;var H=y.total;for(var L=0;L<H;L++){if(scheduler._ignores[L]){scheduler._cols[L]=0;s++}else{scheduler._cols[L]=Math.floor(I/(s-L))}I-=scheduler._cols[L];u[L+1]=u[L]+scheduler._cols[L]}P.innerHTML="<div></div>";if(this.second_scale){var E=this.second_scale.x_unit;var Q=[this._trace_x[0]];var G=[];var z=[this.dx,this.dx];var B=0;for(var K=0;K<this._trace_x.length;K++){var T=this._trace_x[K];var U=h(E,T,Q[B]);if(U){++B;Q[B]=T;z[B+1]=z[B]}var D=B+1;G[B]=scheduler._cols[K]+(G[B]||0);z[D]+=scheduler._cols[K]}P.innerHTML="<div></div><div></div>";var F=P.firstChild;F.style.height=(r)+"px";var A=P.lastChild;A.style.position="relative";for(var J=0;J<Q.length;J++){var C=Q[J];var S=scheduler.templates[this.name+"_second_scalex_class"](C);var x=document.createElement("DIV");x.className="dhx_scale_bar dhx_second_scale_bar"+((S)?(" "+S):"");scheduler.set_xy(x,G[J]-1,r-3,z[J],0);x.innerHTML=scheduler.templates[this.name+"_second_scale_date"](C);F.appendChild(x)}}scheduler.xy.scale_height=r;P=P.lastChild;for(var N=0;N<this._trace_x.length;N++){if(scheduler._ignores[N]){continue}v=this._trace_x[N];scheduler._render_x_header(N,u[N],v,P);var w=scheduler.templates[this.name+"_scalex_class"](v);if(w){P.lastChild.className+=" "+w}}scheduler.xy.scale_height=R;var M=this._trace_x;P.onclick=function(t){var W=b(t);if(W){scheduler.callEvent("onXScaleClick",[W.x,M[W.x],t||event])}};P.ondblclick=function(t){var W=b(t);if(W){scheduler.callEvent("onXScaleDblClick",[W.x,M[W.x],t||event])}}}function h(t,r,s){switch(t){case"hour":return((r.getHours()!=s.getHours())||h("day",r,s));case"day":return !(r.getDate()==s.getDate()&&r.getMonth()==s.getMonth()&&r.getFullYear()==s.getFullYear());case"week":return !(scheduler.date.getISOWeek(r)==scheduler.date.getISOWeek(s)&&r.getFullYear()==s.getFullYear());case"month":return !(r.getMonth()==s.getMonth()&&r.getFullYear()==s.getFullYear());case"year":return !(r.getFullYear()==s.getFullYear());default:return false}}function c(s){if(s){scheduler.set_sizes();scheduler._init_matrix_tooltip();var r=scheduler._min_date;f.call(this,scheduler._els.dhx_cal_header[0]);a.call(this,scheduler._els.dhx_cal_data[0]);scheduler._min_date=r;scheduler._els.dhx_cal_date[0].innerHTML=scheduler.templates[this.name+"_date"](scheduler._min_date,scheduler._max_date);if(scheduler._mark_now){scheduler._mark_now()}}l()}function l(){if(scheduler._tooltip){scheduler._tooltip.style.display="none";scheduler._tooltip.date=""}}function o(v,y,u){if(v.render!="cell"){return}var s=y.x+"_"+y.y;var A=v._matrix[y.y][y.x];if(!A){return l()}A.sort(function(C,t){return C.start_date>t.start_date?1:-1});if(scheduler._tooltip){if(scheduler._tooltip.date==s){return}scheduler._tooltip.innerHTML=""}else{var B=scheduler._tooltip=document.createElement("DIV");B.className="dhx_year_tooltip";document.body.appendChild(B);B.onclick=scheduler._click.dhx_cal_data}var x="";for(var w=0;w<A.length;w++){var z=(A[w].color?("background-color:"+A[w].color+";"):"");var r=(A[w].textColor?("color:"+A[w].textColor+";"):"");x+="<div class='dhx_tooltip_line' event_id='"+A[w].id+"' style='"+z+""+r+"'>";x+="<div class='dhx_tooltip_date'>"+(A[w]._timed?scheduler.templates.event_date(A[w].start_date):"")+"</div>";x+="<div class='dhx_event_icon icon_details'>&nbsp;</div>";x+=scheduler.templates[v.name+"_tooltip"](A[w].start_date,A[w].end_date,A[w])+"</div>"}scheduler._tooltip.style.display="";scheduler._tooltip.style.top="0px";if(document.body.offsetWidth-u.left-scheduler._tooltip.offsetWidth<0){scheduler._tooltip.style.left=u.left-scheduler._tooltip.offsetWidth+"px"}else{scheduler._tooltip.style.left=u.left+y.src.offsetWidth+"px"}scheduler._tooltip.date=s;scheduler._tooltip.innerHTML=x;if(document.body.offsetHeight-u.top-scheduler._tooltip.offsetHeight<0){scheduler._tooltip.style.top=u.top-scheduler._tooltip.offsetHeight+y.src.offsetHeight+"px"}else{scheduler._tooltip.style.top=u.top+"px"}}scheduler._matrix_tooltip_handler=function(s){var r=scheduler.matrix[scheduler._mode];if(!r||r.render!="cell"){return}if(r){var u=scheduler._locate_cell_timeline(s);var s=s||event;var t=s.target||s.srcElement;if(u){return o(r,u,getOffset(u.src))}}l()};scheduler._init_matrix_tooltip=function(){scheduler._detachDomEvent(scheduler._els.dhx_cal_data[0],"mouseover",scheduler._matrix_tooltip_handler);dhtmlxEvent(scheduler._els.dhx_cal_data[0],"mouseover",scheduler._matrix_tooltip_handler)};scheduler._set_timeline_dates=function(r){scheduler._min_date=scheduler.date[r.name+"_start"](new Date(scheduler._date));scheduler._max_date=scheduler.date["add_"+r.name+"_private"](scheduler._min_date,r.x_size*r.x_step);scheduler._table_view=true};scheduler._renderMatrix=function(s,r){if(!r){scheduler._els.dhx_cal_data[0].scrollTop=0}scheduler._set_timeline_dates(this);if(this.second_scale){if(s&&!this._header_resized){this._header_resized=scheduler.xy.scale_height;scheduler.xy.scale_height*=2;scheduler._els.dhx_cal_header[0].className+=" dhx_second_cal_header"}if(!s&&this._header_resized){scheduler.xy.scale_height/=2;this._header_resized=false;var t=scheduler._els.dhx_cal_header[0];t.className=t.className.replace(/ dhx_second_cal_header/gi,"")}}c.call(this,s)};function k(s){var t=s.parentNode.childNodes;for(var r=0;r<t.length;r++){if(t[r]==s){return r}}return -1}function b(t){t=t||event;var r=t.target?t.target:t.srcElement;while(r&&r.tagName!="DIV"){r=r.parentNode}if(r&&r.tagName=="DIV"){var s=r.className.split(" ")[0];if(s=="dhx_scale_bar"){return{x:k(r),y:-1,src:r,scale:true}}}}scheduler._locate_cell_timeline=function(w){w=w||event;var t=w.target?w.target:w.srcElement;var u={};var s=scheduler.matrix[scheduler._mode];var y=scheduler.getActionData(w);for(var x=0;x<s._trace_x.length-1;x++){if(+y.date<s._trace_x[x+1]){break}}u.x=x;u.y=s.order[y.section];var v=scheduler._isRender("cell")?1:0;u.src=s._scales[y.section]?s._scales[y.section].getElementsByTagName("td")[x+v]:null;var r=false;while(u.x===0&&t.className!="dhx_cal_data"&&t.parentNode){if(t.className.split(" ")[0]=="dhx_matrix_scell"){r=true;break}else{t=t.parentNode}}if(r){u.x=-1;u.src=t;u.scale=true}return u};var n=scheduler._click.dhx_cal_data;scheduler._click.dhx_marked_timespan=scheduler._click.dhx_cal_data=function(t){var r=n.apply(this,arguments);var s=scheduler.matrix[scheduler._mode];if(s){var u=scheduler._locate_cell_timeline(t);if(u){if(u.scale){scheduler.callEvent("onYScaleClick",[u.y,s.y_unit[u.y],t||event])}else{scheduler.callEvent("onCellClick",[u.x,u.y,s._trace_x[u.x],(((s._matrix[u.y]||{})[u.x])||[]),t||event])}}}return r};scheduler.dblclick_dhx_matrix_cell=function(s){var r=scheduler.matrix[scheduler._mode];if(r){var t=scheduler._locate_cell_timeline(s);if(t){if(t.scale){scheduler.callEvent("onYScaleDblClick",[t.y,r.y_unit[t.y],s||event])}else{scheduler.callEvent("onCellDblClick",[t.x,t.y,r._trace_x[t.x],(((r._matrix[t.y]||{})[t.x])||[]),s||event])}}}};var g=scheduler.dblclick_dhx_marked_timespan||function(){};scheduler.dblclick_dhx_marked_timespan=function(s){var r=scheduler.matrix[scheduler._mode];if(r){return scheduler.dblclick_dhx_matrix_cell(s)}else{return g.apply(this,arguments)}};scheduler.dblclick_dhx_matrix_scell=function(r){return scheduler.dblclick_dhx_matrix_cell(r)};scheduler._isRender=function(r){return(scheduler.matrix[scheduler._mode]&&scheduler.matrix[scheduler._mode].render==r)};scheduler.attachEvent("onCellDblClick",function(s,z,t,r,v){if(this.config.readonly||(v.type=="dblclick"&&!this.config.dblclick_create)){return}var w=scheduler.matrix[scheduler._mode];var u={};u.start_date=w._trace_x[s];u.end_date=(w._trace_x[s+1])?w._trace_x[s+1]:scheduler.date.add(w._trace_x[s],w.x_step,w.x_unit);if(w._start_correction){u.start_date=new Date(u.start_date*1+w._start_correction)}if(w._end_correction){u.end_date=new Date(u.end_date-w._end_correction)}u[w.y_property]=w.y_unit[z].key;scheduler.addEventNow(u,null,v)});scheduler.attachEvent("onBeforeDrag",function(s,t,r){return !scheduler._isRender("cell")});scheduler.attachEvent("onEventChanged",function(s,r){r._timed=this.isOneDayEvent(r)});scheduler.attachEvent("onBeforeEventChanged",function(t,u,r,s){if(scheduler._events[t.id]){t._move_delta=undefined}return true});scheduler._is_column_visible=function(r){var t=scheduler.matrix[scheduler._mode];var s=scheduler._get_date_index(t,r);return !scheduler._ignores[s]};var j=scheduler._render_marked_timespan;scheduler._render_marked_timespan=function(w,O,x,u,D){if(!scheduler.config.display_marked_timespans){return[]}if(scheduler.matrix&&scheduler.matrix[scheduler._mode]){if(scheduler._isRender("cell")){return}var S=scheduler._lame_copy({},scheduler.matrix[scheduler._mode]);S.round_position=false;var Q=[];var I=[];var z=[];var A=w.sections?(w.sections.units||w.sections.timeline):null;if(!x){var L=S.order;if(A){if(L.hasOwnProperty(A)){I.push(A);z.push(S._scales[A])}}else{for(var T in L){if(L.hasOwnProperty(T)){I.push(T);z.push(S._scales[T])}}}}else{z=[O];I=[x]}var u=u?new Date(u):scheduler._min_date;var D=D?new Date(D):scheduler._max_date;if(u.valueOf()<scheduler._min_date.valueOf()){u=new Date(scheduler._min_date)}if(D.valueOf()>scheduler._max_date.valueOf()){D=new Date(scheduler._max_date)}for(var M=0;M<S._trace_x.length;M++){if(scheduler._is_column_visible(S._trace_x[M])){break}}if(M==S._trace_x.length){return}var y=[];if(w.days>6){var P=new Date(w.days);if(scheduler.date.date_part(new Date(u))<=+P&&+D>=+P){y.push(P)}}else{y.push.apply(y,scheduler._get_dates_by_index(w.days))}var G=w.zones;var N=scheduler._get_css_classes_by_config(w);for(var K=0;K<I.length;K++){O=z[K];x=I[K];for(var M=0;M<y.length;M++){var R=y[M];for(var J=0;J<G.length;J+=2){var r=G[J];var C=G[J+1];var v=new Date(+R+r*60*1000);var s=new Date(+R+C*60*1000);if(!(u<s&&D>v)){continue}var B=scheduler._get_block_by_config(w);B.className=N;var E=i({start_date:v},false,S)-1;var t=i({start_date:s},false,S)-1;var H=Math.max(1,t-E-1);var F=S._section_height[x]-1;B.style.cssText="height: "+F+"px; left: "+E+"px; width: "+H+"px; top: 0;";O.insertBefore(B,O.firstChild);Q.push(B)}}}return Q}else{return j.apply(scheduler,[w,O,x])}};var m=scheduler._append_mark_now;scheduler._append_mark_now=function(u,t){if(scheduler.matrix&&scheduler.matrix[scheduler._mode]){var s=scheduler._currentDate();var v=scheduler._get_zone_minutes(s);var r={days:+scheduler.date.date_part(s),zones:[v,v+1],css:"dhx_matrix_now_time",type:"dhx_now_time"};return scheduler._render_marked_timespan(r)}else{return m.apply(scheduler,[u,t])}};scheduler.attachEvent("onScaleAdd",function(w,F){var t=scheduler._marked_timespans;if(t&&scheduler.matrix&&scheduler.matrix[scheduler._mode]){var A=scheduler._mode;var u=scheduler._min_date;var H=scheduler._max_date;var D=t.global;for(var B=scheduler.date.date_part(new Date(u));B<H;B=scheduler.date.add(B,1,"day")){var x=+B;var s=B.getDay();var G=[];var r=D[x]||D[s];G.push.apply(G,scheduler._get_configs_to_render(r));if(t[A]&&t[A][F]){var E=[];var z=scheduler._get_types_to_render(t[A][F][s],t[A][F][x]);E.push.apply(E,scheduler._get_configs_to_render(z));if(E.length){G=E}}for(var y=0;y<G.length;y++){var v=G[y];var C=v.days;if(C<7){C=x;scheduler._render_marked_timespan(v,w,F,B,scheduler.date.add(B,1,"day"));C=s}else{scheduler._render_marked_timespan(v,w,F,B,scheduler.date.add(B,1,"day"))}}}}});scheduler._resolve_timeline_section=function(r,u){var s=0;var t=0;for(s;s<this._colsS.heights.length;s++){t+=this._colsS.heights[s];if(t>u.y){break}}if(!r.y_unit[s]){s=r.y_unit.length-1}if(this._drag_event&&!this._drag_event._orig_section){this._drag_event._orig_section=r.y_unit[s].key}u.fields={};if(s>=0&&r.y_unit[s]){u.section=u.fields[r.y_property]=r.y_unit[s].key}};scheduler._update_timeline_section=function(u){var r=u.view,s=u.event,v=u.pos;if(s){if(s[r.y_property]!=v.section){var t=this._get_timeline_event_height(s,r);s._sorder=this._get_dnd_order(s._sorder,t,r._section_height[v.section])}s[r.y_property]=v.section}};scheduler._get_date_index=function(u,t){var s=0;var r=u._trace_x;while(s<r.length-1&&+t>=+r[s+1]){s++}return s};scheduler._timeline_drag_date=function(B,r){var v=B,x={x:r};var y=0,A=0;var w,z;for(A;A<=this._cols.length-1;A++){z=this._cols[A];y+=z;if(y>x.x){w=(x.x-(y-z))/z;w=(w<0)?0:w;break}}if(v.round_position){var t=1;if(scheduler.getState().drag_mode&&scheduler.getState().drag_mode!="move"){t=0.5}if(w>=t){A++}w=0}if(A===0&&this._ignores[0]){A=1;w=0;while(this._ignores[A]){A++}}else{if(A==this._cols.length&&this._ignores[A-1]){A=this._cols.length-1;w=0;while(this._ignores[A]){A--}A++}}var s;if(A>=v._trace_x.length){s=scheduler.date.add(v._trace_x[v._trace_x.length-1],v.x_step,v.x_unit);if(v._end_correction){s=new Date(s-v._end_correction)}}else{var u=w*z*v._step+v._start_correction;s=new Date(+v._trace_x[A]+u)}return s};scheduler.attachEvent("onBeforeTodayDisplayed",function(){for(var r in scheduler.matrix){var s=scheduler.matrix[r];s.x_start=s._original_x_start}return true});scheduler.attachEvent("onOptionsLoad",function(){for(var r in scheduler.matrix){var s=scheduler.matrix[r];s.order={};scheduler.callEvent("onOptionsLoadStart",[]);for(var r=0;r<s.y_unit.length;r++){s.order[s.y_unit[r].key]=r}scheduler.callEvent("onOptionsLoadFinal",[]);if(scheduler._date&&s.name==scheduler._mode){scheduler.setCurrentView(scheduler._date,scheduler._mode)}}});scheduler.attachEvent("onSchedulerResize",function(){if(scheduler.matrix[this._mode]){var r=scheduler.matrix[this._mode];scheduler._renderMatrix.call(r,true,true);return false}return true});scheduler.attachEvent("onBeforeDrag",function(u,s,t){if(s=="resize"){var r=t.target||t.srcElement;if((r.className||"").indexOf("dhx_event_resize_end")<0){scheduler._drag_from_start=true}else{scheduler._drag_from_start=false}}return true})};scheduler._temp_matrix_scope();
/*!
--------------- Tree timeline Plugin --------------------
 */
;Scheduler.plugin(function(b){b.attachEvent("onTimelineCreated",function(c){if(c.render=="tree"){c.y_unit_original=c.y_unit;c.y_unit=b._getArrayToDisplay(c.y_unit_original);b.attachEvent("onOptionsLoadStart",function(){c.y_unit=b._getArrayToDisplay(c.y_unit_original)});b.form_blocks[c.name]={render:function(e){var d="<div class='dhx_section_timeline' style='overflow: hidden; height: "+e.height+"px'></div>";return d},set_value:function(f,l,j,e){var m=b._getArrayForSelect(b.matrix[e.type].y_unit_original,e.type);f.innerHTML="";var h=document.createElement("select");f.appendChild(h);var k=f.getElementsByTagName("select")[0];if(!k._dhx_onchange&&e.onchange){k.onchange=e.onchange;k._dhx_onchange=true}for(var g=0;g<m.length;g++){var d=document.createElement("option");d.value=m[g].key;if(d.value==j[b.matrix[e.type].y_property]){d.selected=true}d.innerHTML=m[g].label;k.appendChild(d)}},get_value:function(f,e,d){return f.firstChild.value},focus:function(d){}}}});b.attachEvent("onBeforeSectionRender",function(m,h,k){var i={};if(m=="tree"){var l;var g,c,d;var f;var j;if(h.children){l=k.folder_dy||k.dy;if(k.folder_dy&&!k.section_autoheight){c="height:"+k.folder_dy+"px;"}g="dhx_row_folder";d="dhx_matrix_scell folder";f="<div class='dhx_scell_expand'>"+((h.open)?"-":"+")+"</div>";j=(k.folder_events_available)?"dhx_data_table folder_events":"dhx_data_table folder"}else{l=k.dy;g="dhx_row_item";d="dhx_matrix_scell item"+(b.templates[k.name+"_scaley_class"](h.key,h.label,h)?" "+b.templates[k.name+"_scaley_class"](h.key,h.label,h):"");f="";j="dhx_data_table"}var e="<div class='dhx_scell_level"+h.level+"'>"+f+"<div class='dhx_scell_name'>"+(b.templates[k.name+"_scale_label"](h.key,h.label,h)||h.label)+"</div></div>";i={height:l,style_height:c,tr_className:g,td_className:d,td_content:e,table_className:j}}return i});var a;b.attachEvent("onBeforeEventChanged",function(h,e,g){if(b._isRender("tree")){var d=b._get_event_sections?b._get_event_sections(h):[h[b.matrix[b._mode].y_property]];for(var c=0;c<d.length;c++){var f=b.getSection(d[c]);if(f&&typeof f.children!="undefined"&&!b.matrix[b._mode].folder_events_available){if(!g){h[b.matrix[b._mode].y_property]=a}return false}}}return true});b.attachEvent("onBeforeDrag",function(h,i,e){if(b._isRender("tree")){var c=b._locate_cell_timeline(e);var d;if(c){d=b.matrix[b._mode].y_unit[c.y].key;if(typeof b.matrix[b._mode].y_unit[c.y].children!="undefined"&&!b.matrix[b._mode].folder_events_available){return false}}var f=b.getEvent(h);var g=b.matrix[b._mode].y_property;a=(f&&f[g])?f[g]:d}return true});b._getArrayToDisplay=function(e){var c=[];var d=function(j,f){var h=f||0;for(var g=0;g<j.length;g++){j[g].level=h;if(typeof j[g].children!="undefined"&&typeof j[g].key=="undefined"){j[g].key=b.uid()}c.push(j[g]);if(j[g].open&&j[g].children){d(j[g].children,h+1)}}};d(e);return c};b._getArrayForSelect=function(f,e){var c=[];var d=function(h){for(var g=0;g<h.length;g++){if(b.matrix[e].folder_events_available){c.push(h[g])}else{if(typeof h[g].children=="undefined"){c.push(h[g])}}if(h[g].children){d(h[g].children,e)}}};d(f);return c};b._toggleFolderDisplay=function(g,d,c){var f;var e=function(m,n,k,j){for(var l=0;l<n.length;l++){if((n[l].key==m||j)&&n[l].children){n[l].open=(typeof k!="undefined")?k:!n[l].open;f=true;if(!j&&f){break}}if(n[l].children){e(m,n[l].children,k,j)}}};var h=b.getSection(g);if((typeof d=="undefined")&&!c){d=!h.open}if(b.callEvent("onBeforeFolderToggle",[h,d,c])){e(g,b.matrix[b._mode].y_unit_original,d,c);b.matrix[b._mode].y_unit=b._getArrayToDisplay(b.matrix[b._mode].y_unit_original);b.callEvent("onOptionsLoad",[]);b.callEvent("onAfterFolderToggle",[h,d,c])}};b.attachEvent("onCellClick",function(d,g,e,c,f){if(b._isRender("tree")){if(!b.matrix[b._mode].folder_events_available){if(typeof b.matrix[b._mode].y_unit[g]!="undefined"&&typeof b.matrix[b._mode].y_unit[g].children!="undefined"){b._toggleFolderDisplay(b.matrix[b._mode].y_unit[g].key)}}}});b.attachEvent("onYScaleClick",function(c,e,d){if(b._isRender("tree")){if(typeof e.children!="undefined"){b._toggleFolderDisplay(e.key)}}});b.getSection=function(e){if(b._isRender("tree")){var d;var c=function(g,h){for(var f=0;f<h.length;f++){if(h[f].key==g){d=h[f]}if(h[f].children){c(g,h[f].children)}}};c(e,b.matrix[b._mode].y_unit_original);return d||null}};b.deleteSection=function(e){if(b._isRender("tree")){var c=false;var d=function(g,h){for(var f=0;f<h.length;f++){if(h[f].key==g){h.splice(f,1);c=true}if(c){break}if(h[f].children){d(g,h[f].children)}}};d(e,b.matrix[b._mode].y_unit_original);b.matrix[b._mode].y_unit=b._getArrayToDisplay(b.matrix[b._mode].y_unit_original);b.callEvent("onOptionsLoad",[]);return c}};b.deleteAllSections=function(){if(b._isRender("tree")){b.matrix[b._mode].y_unit_original=[];b.matrix[b._mode].y_unit=b._getArrayToDisplay(b.matrix[b._mode].y_unit_original);b.callEvent("onOptionsLoad",[])}};b.addSection=function(f,d){if(b._isRender("tree")){var c=false;var e=function(j,g,k){if(!d){k.push(j);c=true}else{for(var h=0;h<k.length;h++){if(k[h].key==g&&typeof k[h].children!="undefined"){k[h].children.push(j);c=true}if(c){break}if(k[h].children){e(j,g,k[h].children)}}}};e(f,d,b.matrix[b._mode].y_unit_original);b.matrix[b._mode].y_unit=b._getArrayToDisplay(b.matrix[b._mode].y_unit_original);b.callEvent("onOptionsLoad",[]);return c}};b.openAllSections=function(){if(b._isRender("tree")){b._toggleFolderDisplay(1,true,true)}};b.closeAllSections=function(){if(b._isRender("tree")){b._toggleFolderDisplay(1,false,true)}};b.openSection=function(c){if(b._isRender("tree")){b._toggleFolderDisplay(c,true)}};b.closeSection=function(c){if(b._isRender("tree")){b._toggleFolderDisplay(c,false)}}});
/*!
------------------- URL Plugin ----------------------
 */
;Scheduler.plugin(function(a){a._get_url_nav=function(){var e={};var d=(document.location.hash||"").replace("#","").split(",");for(var b=0;b<d.length;b++){var c=d[b].split("=");if(c.length==2){e[c[0]]=c[1]}}return e};a.attachEvent("onTemplatesReady",function(){var e=true;var b=a.date.str_to_date("%Y-%m-%d");var c=a.date.date_to_str("%Y-%m-%d");var f=a._get_url_nav().event||null;a.attachEvent("onAfterEventDisplay",function(g){f=null;return true});a.attachEvent("onBeforeViewChange",function(l,g,i,k){if(e){e=false;var h=a._get_url_nav();if(h.event){try{if(a.getEvent(h.event)){d(h.event);return false}else{var q=a.attachEvent("onXLE",function(){d(h.event);a.detachEvent(q)})}}catch(j){}}if(h.date||h.mode){try{this.setCurrentView((h.date?b(h.date):null),(h.mode||null))}catch(j){this.setCurrentView((h.date?b(h.date):null),i)}return false}}var n=["date="+c(k||g),"mode="+(i||l)];if(f){n.push("event="+f)}var o="#"+n.join(",");if(document.location.hash!=o){document.location.hash=o}return true});function d(g){f=g;if(a.getEvent(g)){a.showEvent(g)}}})});
/*!
DHTMLX Api
 */
(function(){var b=false;function c(f,d){for(var e in d){if(!f[e]){f[e]=d[e]}}return f}function a(d){d.exportToPDF=function(e){e=c((e||{}),{name:"calendar.pdf",format:"A4",orientation:"landscape",dpi:96,zoom:1});e.html=e.html||this._export_html(e);e.mode=this.getState().mode;this._send_to_export(e,"pdf")};d.exportToPNG=function(e){e=c((e||{}),{name:"calendar.png",format:"A4",orientation:"landscape",dpi:96,zoom:1});e.html=e.html||this._export_html(e);e.mode=this.getState().mode;this._send_to_export(e,"png")};d.exportToICal=function(e){e=c((e||{}),{name:"calendar.ical",data:this._serialize_plain(null,e)});this._send_to_export(e,"ical")};d.exportToExcel=function(e){e=c((e||{}),{name:"calendar.xlsx",title:"Events",data:this._serialize_plain(this.templates.xml_format,e),columns:this._serialize_columns()});this._send_to_export(e,"excel")}}scheduler._ajax_to_export=function(e,d,f){delete e.callback;dhtmlxAjax.post("/schedule/pdfexport","type="+d+"&store=1&data="+encodeURIComponent(JSON.stringify(e)),function(g){var h=g.xmlDoc.status>400;var j=null;if(!h){try{j=JSON.parse(g.xmlDoc.responseText)}catch(i){}}f(j)})};scheduler._plain_export_copy=function(e,g){var f={};for(var d in e){f[d]=e[d]}f.start_date=g(f.start_date);f.end_date=g(f.end_date);f.$text=this.templates.event_text(e.start_date,e.end_date,e);return f};scheduler._serialize_plain=function(h,d){h=h||scheduler.date.date_to_str("%Y%m%dT%H%i%s",true);var f;if(d&&d.start&&d.end){f=scheduler.getEvents(d.start,d.end)}else{f=scheduler.getEvents()}var g=[];for(var e=0;e<f.length;e++){g[e]=this._plain_export_copy(f[e],h)}return g};scheduler._serialize_columns=function(){return[{id:"start_date",header:"Start Date",width:30},{id:"end_date",header:"End Date",width:30},{id:"$text",header:"Text",width:100}]};scheduler._send_to_export=function(f,d){if(f.callback){return scheduler._ajax_to_export(f,d,f.callback)}var e=this._create_hidden_form();e.firstChild.action="/schedule/pdfexport";e.firstChild.childNodes[0].value=JSON.stringify(f);e.firstChild.childNodes[1].value=d;e.firstChild.submit()};scheduler._create_hidden_form=function(){if(!this._hidden_export_form){var d=this._hidden_export_form=document.createElement("div");d.style.display="none";d.innerHTML="<form method='POST'><input type='text' name='data'><input type='hidden' name='type' value=''></form>";document.body.appendChild(d)}return this._hidden_export_form};scheduler._export_resize=function(){if(scheduler.callEvent("onSchedulerResize",[])){scheduler.update_view();scheduler.callEvent("onAfterSchedulerResize",[])}};scheduler._get_export_size=function(j,e,i,g){var f=10;g=g/25.4;var h={A5:{x:148,y:210},A4:{x:210,y:297},A3:{x:297,y:420},A2:{x:420,y:594},A1:{x:594,y:841},A0:{x:841,y:1189}};var d={x:h[j].x,y:h[j].y};if(e=="landscape"){var k=d.x;d.x=d.y;d.y=k}d.x=Math.floor((d.x-f*2)*g)*1/i;d.y=Math.floor((d.y-f*2)*g);return d};scheduler._export_html=function(i){var j=scheduler.xy.nav_height;var d=scheduler.xy.scroll_width;var e=scheduler._obj.style.width;var h=scheduler._obj.style.height;var g=scheduler._get_export_size(i.format,i.orientation,i.zoom,i.dpi);scheduler._obj.style.width=g.x+"px";scheduler._obj.style.height=g.y+"px";scheduler.xy.nav_height=0;scheduler.xy.scroll_width=0;b=true;scheduler._export_resize();b=false;var f=scheduler._obj.innerHTML;scheduler.xy.scroll_width=d;scheduler.xy.nav_height=j;scheduler._obj.style.width=e;scheduler._obj.style.height=h;scheduler._export_resize();return f};a(scheduler);if(window.Scheduler&&Scheduler.plugin){Scheduler.plugin(a)}})();